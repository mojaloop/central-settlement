{
    "swagger": "2.0",
    "info": {
        "version": "1.0.0",
        "title": "MOJALOOP Central Settlements",
        "description": "Mojaloop API for Settlements."
    },
    "basePath": "/v1",
    "schemes": [
        "http",
        "https"
    ],
    "paths": {
        "/settlementWindows/{id}": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Returns a Settlement Window as per id.",
                "operationId": "getSettlementWindowById",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "type": "integer",
                        "description": "A valid settlement window id to be supplied in the query.\n"
                    }
                ],
                "tags": [
                    "getSettlementWindowById"
                ],
                "responses": {
                    "200": {
                        "description": "A settlement window's data returned.",
                        "schema": {
                            "$ref": "#/definitions/SettlementWindows"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "post": {
                "produces": [
                    "application/json"
                ],
                "consumes": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "If the settlementWindow is open, it can be closed and a new window created. If it is already closed, return an error message. Returns the new settlement window.",
                "operationId": "closeSettlementWindow",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "body",
                        "name": "settlementWindowClosurePayload",
                        "description": "A JSON object containing settlement window closure info.",
                        "schema": {
                            "$ref": "#/definitions/SettlementWindowClosurePayload"
                        },
                        "required": true
                    }
                ],
                "tags": [
                    "closeSettlementWindow"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement window closed and new window opened.",
                        "schema": {
                            "$ref": "#/definitions/SettlementWindow"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/settlementWindows": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Returns a Settlement Window(s) as per parameter(s).",
                "operationId": "getSettlementWindowByParams",
                "parameters": [
                    {
                        "in": "query",
                        "name": "participantId",
                        "type": "integer",
                        "description": "A valid participant Id to filter on.\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "state",
                        "type": "string",
                        "enum": [
                            "open",
                            "closed"
                        ],
                        "description": "A settlement window state (open or closed) to filter on.  \n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "fromDateTime",
                        "type": "string",
                        "format": "date-time",
                        "description": "The start date for query (relates to central-ledger.settlementWindow.createdDate). Can be used together with `toDateTime'. eg 2017-07-20T17:32:28Z\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "toDateTime",
                        "type": "string",
                        "format": "date-time",
                        "description": "The end date for query (relates to central-ledger.settlementWindow.createdDate). Can be used together with `fromDateTime'. eg 2017-07-21T17:32:28Z\n",
                        "required": false
                    }
                ],
                "tags": [
                    "getSettlementWindowByParams"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement window(s) returned by the filtering parameters.",
                        "schema": {
                            "$ref": "#/definitions/SettlementWindows"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/settlements": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Returns Settlement(s) as per parameter(s).",
                "operationId": "getSettlementsByParams",
                "parameters": [
                    {
                        "in": "query",
                        "name": "currency",
                        "type": "string",
                        "description": "A valid currency to filter on.\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "participantId",
                        "type": "integer",
                        "description": "A valid participant Id to filter on.\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "settlementWindowId",
                        "type": "number",
                        "description": "A valid Settlement Window Id to filter on.\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "accountId",
                        "type": "number",
                        "description": "A valid Account Id to filter on.\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "state",
                        "type": "string",
                        "enum": [
                            "open",
                            "closed"
                        ],
                        "description": "A settlement state to filter on.  \n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "fromDateTime",
                        "type": "string",
                        "format": "date-time",
                        "description": "The start date for query (relates to central-ledger.settlementWindow.createdDate). Can be used together with `toDateTime'. eg 2017-07-20T17:32:28Z\n",
                        "required": false
                    },
                    {
                        "in": "query",
                        "name": "toDateTime",
                        "type": "string",
                        "format": "date-time",
                        "description": "The end date for query (relates to central-ledger.settlementWindow.createdDate). Can be used together with `fromDateTime'. eg 2017-07-21T17:32:28Z\n",
                        "required": false
                    }
                ],
                "tags": [
                    "getSettlementsByParams"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement window(s) returned by the filtering parameters.",
                        "schema": {
                            "$ref": "#/definitions/Settlements"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "post": {
                "produces": [
                    "application/json"
                ],
                "consumes": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Trigger the creation of a settlement event, that does the calculation of the net settlement position per participant and marks all transfers in the affected windows as Pending settlement. Returned dataset is the net settlement report for the settlementwindow",
                "operationId": "postSettlementEvent",
                "parameters": [
                    {
                        "in": "body",
                        "name": "settlementEventPayload",
                        "description": "A JSON object containing settlement event info.",
                        "schema": {
                            "$ref": "#/definitions/SettlementEventPayload"
                        },
                        "required": true
                    }
                ],
                "tags": [
                    "postSettlementEvent"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement window(s) returned by the filtering parameters.",
                        "schema": {
                            "$ref": "#/definitions/Account"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/settlements/{settlementId}/participants/{participantId}/accounts/{accountId}": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Returns Settlement(s) as per filter criteria.",
                "operationId": "getSettlementsBySettlementParticipantAccounts",
                "parameters": [
                    {
                        "in": "path",
                        "name": "settlementId",
                        "required": true,
                        "type": "integer",
                        "description": "A valid settlement Id.\n"
                    },
                    {
                        "in": "path",
                        "name": "participantId",
                        "required": true,
                        "type": "integer",
                        "description": "A valid Participant Id.\n"
                    },
                    {
                        "in": "path",
                        "name": "accountId",
                        "required": true,
                        "type": "integer",
                        "description": "A valid Account Id.    \n"
                    }
                ],
                "tags": [
                    "getSettlementsBySettlementParticipantAccounts"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement window(s) returned by the filtering parameters.",
                        "schema": {
                            "$ref": "#/definitions/Account"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "put": {
                "produces": [
                    "application/json"
                ],
                "consumes": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Acknowledegement of settlement by updating the reason and state by Settlements Id, Participant Id and accounts Id.",
                "operationId": "updateSettlementBySettlementParticipantsAccounts",
                "parameters": [
                    {
                        "in": "path",
                        "name": "settlementId",
                        "description": "settlements Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "path",
                        "name": "participantId",
                        "description": "participant Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "path",
                        "name": "accountId",
                        "description": "accounts Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "body",
                        "name": "settlementParticipantAccountUpdate",
                        "description": "A JSON object containing settlement update info.",
                        "schema": {
                            "$ref": "#/definitions/SettlementUpdateBySettlementParticipantsAccounts"
                        },
                        "required": true
                    }
                ],
                "tags": [
                    "updateSettlementBySettlementParticipantsAccounts"
                ],
                "responses": {
                    "200": {
                        "description": "Settlements updated.",
                        "schema": {
                            "$ref": "#/definitions/Settlements"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/settlements/{id}": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Returns Settlement(s) as per parameters/filter criteria.",
                "operationId": "getSettsettlementsById",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "type": "integer",
                        "description": "A valid settlement Id.\n"
                    }
                ],
                "tags": [
                    "getSettsettlementsById"
                ],
                "responses": {
                    "200": {
                        "description": "Settlement successfully returned by the filtering/Query parameters.",
                        "schema": {
                            "$ref": "#/definitions/Settlements"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "put": {
                "produces": [
                    "application/json"
                ],
                "consumes": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Acknowledegement of settlement by updating with Settlements Id.",
                "operationId": "updateSettlementById",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "description": "settlements Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "body",
                        "name": "settlementUpdatePayload",
                        "description": "A JSON object containing settlement update info.",
                        "schema": {
                            "$ref": "#/definitions/SettlementUpdatebySettlementIdPayload"
                        },
                        "required": true
                    }
                ],
                "tags": [
                    "updateSettlementById"
                ],
                "responses": {
                    "200": {
                        "description": "Settlements updated.",
                        "schema": {
                            "$ref": "#/definitions/Settlements"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/settlements/{settlementId}/participants/{participantId}": {
            "put": {
                "produces": [
                    "application/json"
                ],
                "consumes": [
                    "application/json"
                ],
                "deprecated": false,
                "summary": "Acknowledegement of settlement by updating with Settlements Id and Participant Id.",
                "operationId": "updateSettlementBySettlementIdParticipantId",
                "parameters": [
                    {
                        "in": "path",
                        "name": "settlementId",
                        "description": "settlements Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "path",
                        "name": "participantId",
                        "description": "participant Id",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "in": "body",
                        "name": "settlementParticipantUpdatePayload",
                        "description": "A JSON object containing settlement update info.",
                        "schema": {
                            "$ref": "#/definitions/SettlementUpdateBySettlementIDPartricipantIdPayload"
                        },
                        "required": true
                    }
                ],
                "tags": [
                    "updateSettlementBySettlementIdParticipantId"
                ],
                "responses": {
                    "200": {
                        "description": "Settlements updated.",
                        "schema": {
                            "$ref": "#/definitions/Settlements"
                        }
                    },
                    "400": {
                        "description": "Bad request.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "401": {
                        "description": "Authorisation information is missing or invalid.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "404": {
                        "description": "No data found.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "415": {
                        "description": "Unsupported Media Type.",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "Account": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Account Id"
                },
                "reason": {
                    "description": "TBD",
                    "type": "string"
                },
                "state": {
                    "type": "string",
                    "example": "PENDING-SETTLEMENT"
                },
                "netSettlementAmount": {
                    "$ref": "#/definitions/netSettlementAmount"
                }
            }
        },
        "SettlementUpdatebySettlementIdPayload": {
            "type": "object",
            "properties": {
                "participants": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/SettlementUpdateBySettlementIDOuterPayload"
                    }
                }
            }
        },
        "SettlementUpdateBySettlementIDOuterPayload": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer",
                    "description": "Participant Id"
                },
                "accounts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/SettlementUpdateBySettlementIDInnerPayload"
                    }
                }
            }
        },
        "SettlementUpdateBySettlementIDInnerPayload": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer",
                    "description": "A uuid."
                },
                "reason": {
                    "type": "string",
                    "example": "motivation for closure"
                },
                "state": {
                    "type": "string",
                    "example": "closed."
                }
            }
        },
        "SettlementUpdateBySettlementIDPartricipantIdPayload": {
            "type": "object",
            "properties": {
                "accounts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/SettlementUpdateBySettlementIDInnerPayload"
                    }
                }
            }
        },
        "Accounts": {
            "type": "object",
            "properties": {
                "id": {
                    "description": "Paricipant Currency Id",
                    "type": "string"
                },
                "reason": {
                    "description": "TBD",
                    "type": "string"
                },
                "state": {
                    "type": "string",
                    "example": "PENDING-SETTLEMENT"
                },
                "netSettlementAmount": {
                    "$ref": "#/definitions/netSettlementAmount"
                }
            }
        },
        "SettlementWindowClosurePayload": {
            "type": "object",
            "properties": {
                "state": {
                    "type": "string",
                    "example": "closed"
                },
                "reason": {
                    "type": "string",
                    "example": "motivation for closure."
                }
            },
            "required": [
                "state",
                "reason"
            ]
        },
        "SettlementUpdateBySettlementParticipantsAccounts": {
            "type": "object",
            "properties": {
                "state": {
                    "type": "string",
                    "example": "closed"
                },
                "reason": {
                    "type": "string",
                    "example": "motivation for closure"
                }
            },
            "required": [
                "state",
                "reason"
            ]
        },
        "SettlementEventPayload": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer"
                },
                "reason": {
                    "type": "string"
                },
                "settlementWindows": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/SettlementWindow"
                    }
                }
            }
        },
        "SettlementWindow": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer"
                },
                "reason": {
                    "type": "string"
                },
                "state": {
                    "type": "string"
                },
                "createdDate": {
                    "type": "string"
                },
                "changedDate": {
                    "type": "string"
                }
            },
            "required": [
                "id",
                "state",
                "createdDate"
            ]
        },
        "SettlementWindows": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/SettlementWindow"
            }
        },
        "netSettlementAmount": {
            "type": "object",
            "properties": {
                "amount": {
                    "type": "number"
                },
                "currency": {
                    "type": "string"
                }
            }
        },
        "Participant": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer"
                },
                "accounts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Accounts"
                    }
                }
            }
        },
        "Settlements": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/Settlement"
            }
        },
        "Settlement": {
            "type": "object",
            "properties": {
                "Id": {
                    "type": "integer"
                },
                "State": {
                    "type": "string"
                },
                "settlementWindows": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/SettlementWindows"
                    }
                },
                "Participants": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Participant"
                    }
                }
            }
        },
        "Error": {
            "required": [
                "status",
                "code",
                "message"
            ],
            "properties": {
                "status": {
                    "type": "integer"
                },
                "code": {
                    "type": "string",
                    "enum": [
                        "MISSING_REQUIRED_PARAMETER",
                        "INVALID_INPUT",
                        "OTHER"
                    ]
                },
                "message": {
                    "type": "string"
                }
            }
        }
    }
}